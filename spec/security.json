{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "A2A Security Definitions",
  "description": "Security schemes and authentication definitions for the A2A protocol",
  "definitions": {
    "SecurityScheme": {
      "anyOf": [
        {
          "$ref": "#/definitions/APIKeySecurityScheme"
        },
        {
          "$ref": "#/definitions/HTTPAuthSecurityScheme"
        },
        {
          "$ref": "#/definitions/OAuth2SecurityScheme"
        },
        {
          "$ref": "#/definitions/OpenIdConnectSecurityScheme"
        },
        {
          "$ref": "#/definitions/MutualTLSSecurityScheme"
        }
      ],
      "description": "Defines a security scheme that can be used to secure an agent's endpoints.\nThis is a discriminated union type based on the OpenAPI 3.0 Security Scheme Object."
    },
    "SecuritySchemeBase": {
      "description": "Base properties shared by all security schemes.",
      "properties": {
        "description": {
          "description": "Description of this security scheme.",
          "type": "string"
        }
      },
      "type": "object"
    },
    "APIKeySecurityScheme": {
      "description": "API Key security scheme.",
      "properties": {
        "description": {
          "description": "Description of this security scheme.",
          "type": "string"
        },
        "in": {
          "description": "The location of the API key. Valid values are \"query\", \"header\", or \"cookie\".",
          "enum": [
            "cookie",
            "header",
            "query"
          ],
          "type": "string"
        },
        "name": {
          "description": "The name of the header, query or cookie parameter to be used.",
          "type": "string"
        },
        "type": {
          "const": "apiKey",
          "type": "string"
        }
      },
      "required": [
        "in",
        "name",
        "type"
      ],
      "type": "object"
    },
    "HTTPAuthSecurityScheme": {
      "description": "HTTP Authentication security scheme.",
      "properties": {
        "bearerFormat": {
          "description": "A hint to the client to identify how the bearer token is formatted. Bearer tokens are usually\ngenerated by an authorization server, so this information is primarily for documentation\npurposes.",
          "type": "string"
        },
        "description": {
          "description": "Description of this security scheme.",
          "type": "string"
        },
        "scheme": {
          "description": "The name of the HTTP Authentication scheme to be used in the Authorization header as defined\nin RFC7235. The values used SHOULD be registered in the IANA Authentication Scheme registry.\nThe value is case-insensitive, as defined in RFC7235.",
          "type": "string"
        },
        "type": {
          "const": "http",
          "type": "string"
        }
      },
      "required": [
        "scheme",
        "type"
      ],
      "type": "object"
    },
    "OAuth2SecurityScheme": {
      "description": "Defines a security scheme using OAuth 2.0.",
      "properties": {
        "description": {
          "description": "An optional description for the security scheme.",
          "type": "string"
        },
        "flows": {
          "$ref": "#/definitions/OAuthFlows",
          "description": "An object containing configuration information for the supported OAuth 2.0 flows."
        },
        "oauth2MetadataUrl": {
          "description": "URL to the oauth2 authorization server metadata\n[RFC8414](https://datatracker.ietf.org/doc/html/rfc8414). TLS is required.",
          "type": "string"
        },
        "type": {
          "const": "oauth2",
          "description": "The type of the security scheme. Must be 'oauth2'.",
          "type": "string"
        }
      },
      "required": [
        "flows",
        "type"
      ],
      "type": "object"
    },
    "OpenIdConnectSecurityScheme": {
      "description": "OpenID Connect security scheme configuration.",
      "properties": {
        "description": {
          "description": "Description of this security scheme.",
          "type": "string"
        },
        "openIdConnectUrl": {
          "description": "Well-known URL to discover the [[OpenID-Connect-Discovery]] provider metadata.",
          "type": "string"
        },
        "type": {
          "const": "openIdConnect",
          "type": "string"
        }
      },
      "required": [
        "openIdConnectUrl",
        "type"
      ],
      "type": "object"
    },
    "OAuthFlows": {
      "description": "Allows configuration of the supported OAuth Flows",
      "properties": {
        "authorizationCode": {
          "$ref": "#/definitions/AuthorizationCodeOAuthFlow",
          "description": "Configuration for the OAuth Authorization Code flow. Previously called accessCode in OpenAPI 2.0."
        },
        "clientCredentials": {
          "$ref": "#/definitions/ClientCredentialsOAuthFlow",
          "description": "Configuration for the OAuth Client Credentials flow. Previously called application in OpenAPI 2.0"
        },
        "implicit": {
          "$ref": "#/definitions/ImplicitOAuthFlow",
          "description": "Configuration for the OAuth Implicit flow"
        },
        "password": {
          "$ref": "#/definitions/PasswordOAuthFlow",
          "description": "Configuration for the OAuth Resource Owner Password flow"
        }
      },
      "type": "object"
    },
    "AuthorizationCodeOAuthFlow": {
      "description": "Configuration details for a supported OAuth Flow",
      "properties": {
        "authorizationUrl": {
          "description": "The authorization URL to be used for this flow. This MUST be in the form of a URL. The OAuth2\nstandard requires the use of TLS",
          "type": "string"
        },
        "refreshUrl": {
          "description": "The URL to be used for obtaining refresh tokens. This MUST be in the form of a URL. The OAuth2\nstandard requires the use of TLS.",
          "type": "string"
        },
        "scopes": {
          "additionalProperties": {
            "type": "string"
          },
          "description": "The available scopes for the OAuth2 security scheme. A map between the scope name and a short\ndescription for it. The map MAY be empty.",
          "type": "object"
        },
        "tokenUrl": {
          "description": "The token URL to be used for this flow. This MUST be in the form of a URL. The OAuth2 standard\nrequires the use of TLS.",
          "type": "string"
        }
      },
      "required": [
        "authorizationUrl",
        "scopes",
        "tokenUrl"
      ],
      "type": "object"
    },
    "ClientCredentialsOAuthFlow": {
      "description": "Configuration details for a supported OAuth Flow",
      "properties": {
        "refreshUrl": {
          "description": "The URL to be used for obtaining refresh tokens. This MUST be in the form of a URL. The OAuth2\nstandard requires the use of TLS.",
          "type": "string"
        },
        "scopes": {
          "additionalProperties": {
            "type": "string"
          },
          "description": "The available scopes for the OAuth2 security scheme. A map between the scope name and a short\ndescription for it. The map MAY be empty.",
          "type": "object"
        },
        "tokenUrl": {
          "description": "The token URL to be used for this flow. This MUST be in the form of a URL. The OAuth2 standard\nrequires the use of TLS.",
          "type": "string"
        }
      },
      "required": [
        "scopes",
        "tokenUrl"
      ],
      "type": "object"
    },
    "ImplicitOAuthFlow": {
      "description": "Configuration details for a supported OAuth Flow",
      "properties": {
        "authorizationUrl": {
          "description": "The authorization URL to be used for this flow. This MUST be in the form of a URL. The OAuth2\nstandard requires the use of TLS",
          "type": "string"
        },
        "refreshUrl": {
          "description": "The URL to be used for obtaining refresh tokens. This MUST be in the form of a URL. The OAuth2\nstandard requires the use of TLS.",
          "type": "string"
        },
        "scopes": {
          "additionalProperties": {
            "type": "string"
          },
          "description": "The available scopes for the OAuth2 security scheme. A map between the scope name and a short\ndescription for it. The map MAY be empty.",
          "type": "object"
        }
      },
      "required": [
        "authorizationUrl",
        "scopes"
      ],
      "type": "object"
    },
    "PasswordOAuthFlow": {
      "description": "Defines configuration details for the OAuth 2.0 Resource Owner Password flow.",
      "properties": {
        "refreshUrl": {
          "description": "The URL to be used for obtaining refresh tokens. This MUST be a URL.",
          "type": "string"
        },
        "scopes": {
          "additionalProperties": {
            "type": "string"
          },
          "description": "The available scopes for the OAuth2 security scheme. A map between the scope\nname and a short description for it.",
          "type": "object"
        },
        "tokenUrl": {
          "description": "The token URL to be used for this flow. This MUST be a URL.",
          "type": "string"
        }
      },
      "required": [
        "scopes",
        "tokenUrl"
      ],
      "type": "object"
    },
    "MutualTLSSecurityScheme": {
      "description": "Defines a security scheme using mTLS authentication.",
      "properties": {
        "description": {
          "description": "An optional description for the security scheme.",
          "type": "string"
        },
        "type": {
          "const": "mutualTLS",
          "description": "The type of the security scheme. Must be 'mutualTLS'.",
          "type": "string"
        }
      },
      "required": [
        "type"
      ],
      "type": "object"
    }
  }
}